# 小米手环心率监控器

一个用Python编写的实时心率监控程序，可以连接小米手环并实时接收心率数据，自动保存为CSV格式。

## 功能特点

- 🔗 **自动扫描**：自动发现并扫描支持心率服务的小米手环
- 📱 **设备选择**：提供友好的设备选择界面
- 💓 **实时监控**：实时接收和显示心率数据
- 📊 **自动保存**：自动将心率数据保存为CSV文件
- 🎯 **去重显示**：避免重复设备信息显示
- ⚡ **简洁界面**：简化的输出格式，专注于核心数据

## 系统要求

- **操作系统**：Windows 10/11、macOS 10.14+、Linux
- **Python版本**：Python 3.7+
- **蓝牙支持**：需要系统支持蓝牙低功耗(BLE)

## 安装依赖

```bash
pip install -r requirements.txt
```

或手动安装：
```bash
pip install bleak
```

## 使用方法

### 1. 开启手环心率广播

1. 打开小米手环设置
2. 进入设备管理页面
3. 找到"心率广播"选项
4. 开启心率广播功能

### 2. 运行程序

```bash
python main.py
```

### 3. 选择设备

程序会自动扫描附近的心率设备，显示设备列表：

```
==================================================
目前找到心率设备：
1. Xiaomi Smart Band 9 (XX:XX:XX:XX:XX:XX)
2. 其他心率设备 (XX:XX:XX:XX:XX:XX)

请选择连接的设备 (输入数字): 
```

输入对应的数字选择要连接的设备。

### 4. 开始监控

连接成功后，程序会开始实时显示心率数据：

```
数据将保存到: heart_rate_XXXXXXXX_XXXXXX.csv
正在订阅心率数据...
开始接收心率数据... (按 Ctrl+C 停止)
01:16:47 心率: 83 BPM
01:16:51 心率: 83 BPM
01:16:53 心率: 82 BPM
...
```

按 `Ctrl+C` 停止程序。

## 数据格式

### 实时显示格式
```
时间 心率: XX BPM
```

### CSV文件格式
程序会自动生成以时间命名的CSV文件，格式如下：

```csv
time,rate
01:16:47,83
01:16:51,83
01:16:53,82
01:16:55,81
...
```

文件名格式：`heart_rate_YYYYMMDD_HHMMSS.csv`

```
MibandHeart/
├── main.py              # 主程序
├── requirements.txt     # 依赖列表
├── README.md           # 说明文档
├── .gitignore          # Git忽略文件
└── heart_rate_*.csv    # 生成的心率数据文件
```

## 许可证

MIT License
